Sub СопоставитьПризнаки()

'Объявляем переменные
Dim ws As Worksheet
Dim i As Long, j As Long, k As Long
Dim LastRowA As Long, LastRowI As Long
Dim ID As String, Flag As String
Dim arrFlags() As String

'Назначаем переменным объекты
Set ws = ThisWorkbook.ActiveSheet
LastRowA = ws.Range("A" & Rows.Count).End(xlUp).Row
LastRowI = ws.Range("I" & Rows.Count).End(xlUp).Row

'Заполняем массив
ReDim arrFlags(LastRowI - 1)
For i = 2 To LastRowI
    arrFlags(i - 2) = ws.Range("J" & i).Value
Next i

'Перебираем все ID в столбце A
For i = 2 To LastRowA
    ID = ws.Range("A" & i).Value

    'Ищем ID в столбце I
    For j = 2 To LastRowI
        If ID = ws.Range("I" & j).Value Then
            Flag = arrFlags(j - 2)
            Exit For
        End If
    Next j

    'Записываем найденный признак в столбец G
    ws.Range("G" & i).Value = Flag
Next i

End Sub
