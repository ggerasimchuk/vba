Sub СопоставитьID()

'Объявляем переменные
Dim ws As Worksheet
Dim LastRowA As Long
Dim LastRowI As Long
Dim i As Long
Dim j As Long
Dim ID As String
Dim Flag As Boolean

'Указываем лист
Set ws = ThisWorkbook.Sheets("Sheet1")

'Определяем последнюю строку в столбце A
LastRowA = ws.Range("A" & Rows.Count).End(xlUp).Row

'Определяем последнюю строку в столбце I
LastRowI = ws.Range("I" & Rows.Count).End(xlUp).Row

'Перебираем все ID в столбце A
For i = 2 To LastRowA
    
    'Получаем ID
    ID = ws.Range("A" & i).Value
    
    'Сброс флага
    Flag = False
    
    'Перебираем все ID в столбце I
    For j = 2 To LastRowI
        
        'Если ID совпадают
        If ID = ws.Range("I" & j).Value Then
            
            'Записываем признак в столбец G
            ws.Range("G" & i).Value = ws.Range("J" & (j + 1)).Value
            
            'Флаг найден
            Flag = True
            
            'Выходим из цикла
            Exit For
        End If
    Next j
    
    'Если ID не найден
    If Not Flag Then
        
        'Записываем сообщение об ошибке
        ws.Range("G" & i).Value = "ID не найден"
    End If
Next i

End Sub
